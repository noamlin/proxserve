parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"GM15":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NID=exports.ND=exports.eventNames=exports.proxyStatuses=exports.nodeStatuses=exports.proxyTypes=void 0;let e=["Object","Array"];exports.proxyTypes=e,e.OBJECT=e[0],e.ARRAY=e[1];let t=["active","stopped","blocked","splicing"];exports.nodeStatuses=t,t.ACTIVE=t[0],t.STOPPED=t[1],t.BLOCKED=t[2],t.SPLICING=t[3];let s=["alive","deleted","revoked"];exports.proxyStatuses=s,s.ALIVE=s[0],s.DELETED=s[1],s.REVOKED=s[2];let o=["create","update","delete","splice","shift","unshift"];exports.eventNames=o,o.CREATE=o[0],o.UPDATE=o[1],o.DELETE=o[2],o.SPLICE=o[3],o.SHIFT=o[4],o.UNSHIFT=o[5];let r=Symbol.for("proxserve_node_data");exports.ND=r;let p=Symbol.for("proxserve_node_inherited_data");exports.NID=p;
},{}],"MDxB":[function(require,module,exports) {
"use strict";function e(e){let t=Object.prototype.toString.call(e);return t.substring(8,t.length-1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.realtypeof=e,exports.simpleClone=r,exports.splitPath=l,exports.evalPath=n;let t=new WeakSet;function r(l){let n,o=e(l);if("Object"===o){t.add(l),n={};let e=Object.keys(l);for(let o of e)t.has(l[o])?n[o]=l[o]:n[o]=r(l[o])}else if("Array"===o){t.add(l),n=[];for(let e=0;e<l.length;e++)t.has(l[e])?n[e]=l[e]:n[e]=r(l[e])}else n=l,"Undefined"!==o&&"Null"!==o&&"Boolean"!==o&&"Number"!==o&&"BigInt"!==o&&"String"!==o&&console.warn(`Can't clone a variable of type ${o}`);return n}function l(e){if("string"!=typeof e||""===e)return[];let t=0,r=!1,l=!1;"."===e[0]?t=1:"["===e[0]&&(t=1,r=!0,l=!0);let n=[],o="";for(;t<e.length;t++){let i=e[t];if(r)if("]"===i)l?n.push(parseInt(o,10)):n.push(o),r=!1,l=!1,o="";else{if(l){let e=i.charCodeAt(0);(e<48||e>57)&&(l=!1)}o+=i}else"["===i&&(r=!0,l=!0),"."===i||"["===i?""!==o&&(n.push(o),o=""):o+=i}return""!==o&&n.push(o),n}function n(e,t){if(""===t)return{object:e,property:void 0,value:e};let r,n=l(t);for(r=0;r<=n.length-2;r++)if(void 0===(e=e[n[r]]))throw new Error(`Invalid path was given - "${t}"`);return{object:e,property:n[r],value:e[n[r]]}}
},{}],"tgn0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.property2path=r,exports.unproxify=o,exports.createDataNode=a;var e=require("./global-vars.js"),t=require("./general-functions.js");function r(e,r){if("symbol"==typeof r)throw new Error("property of type \"symbol\" isn't path'able");let o=(0,t.realtypeof)(e);switch(o){case"Object":return`.${r}`;case"Array":return`[${r}]`;default:return console.warn(`Not Implemented (type of '${o}')`),r}}function o(r){let a=(0,t.realtypeof)(r);if(e.proxyTypes.includes(a)){let e=r;try{e=r.$getOriginalTarget()}catch(s){}switch(a){case"Object":let t=Object.keys(e);for(let r of t)e[r]=o(e[r]);break;case"Array":for(let r=0;r<e.length;r++)e[r]=o(e[r]);break;default:console.warn(`Not Implemented (type of '${typeofobj}')`)}return e}return r}function a(t,o){let a;a=t[e.ND]&&t[e.ND].objects&&t[e.ND].objects.target?r(t[e.ND].objects.target,o):r({},o);let s=t[o];return s||(s={[e.NID]:Object.create(t[e.NID]),[e.ND]:{parentNode:t,listeners:{shallow:[],deep:[]}}},t[o]=s),delete s[e.NID].status,Object.assign(s[e.ND],{path:t[e.ND].path+a,propertyPath:a,objects:Object.assign(Object.create(t[e.ND].objects),{target:void 0,proxy:void 0,revoke:void 0})}),s}
},{"./global-vars.js":"GM15","./general-functions.js":"MDxB"}],"hyxV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stop=o,exports.block=r,exports.activate=s,exports.on=i,exports.once=a,exports.removeListener=l,exports.removeAllListeners=c,exports.getOriginalTarget=u,exports.getProxserveObjects=f,exports.getProxserveDataNode=p,exports.getProxserveInstance=d;var e=require("./global-vars.js"),t=require("./supporting-functions.js"),n=require("./general-functions.js");function o(t){t[e.NID].status=e.nodeStatuses.STOPPED}function r(t){t[e.NID].status=e.nodeStatuses.BLOCKED}function s(t,n,o=!1){o||t===this.dataTree?t[e.NID].status=e.nodeStatuses.ACTIVE:delete t[e.NID].status}function i(o,r,s,i,a,{deep:l=!1,id:c,once:u=!1}={}){"change"===s?s=e.eventNames.slice(0):Array.isArray(s)||(s=[s]);for(let t of s)if(!e.eventNames.includes(t))throw new Error(`${t} is not a valid event. valid events are ${e.eventNames.join(",")}`);if("function"==typeof i)"object"==typeof a&&("boolean"==typeof a.deep&&(l=a.deep),void 0!==a.id&&(c=a.id),"boolean"==typeof a.once&&(u=a.once)),a=i,i="";else if("function"!=typeof a)throw new Error("invalid arguments were given. listener must be a function");let f=(0,n.splitPath)(i);for(let e of f)o[e]||(0,t.createDataNode)(o,e),o=o[e];let p=o[e.ND].listeners.shallow;l&&(p=o[e.ND].listeners.deep);let d={type:s,once:u,func:a};void 0!==c&&(d.id=c),p.push(d)}function a(e,t,n,o,r,s){"object"!=typeof s&&(s={}),s.once=!0,i.call(this,e,t,n,o,r,s)}function l(t,o,r,s){3===arguments.length&&(s=r,r="");let i=`${t[e.ND].path}${r}`,a=(0,n.splitPath)(r);for(let e of a){if(!t[e])return void console.warn(`can't remove listener from a non-existent path '${i}'`);t=t[e]}function l(e,t){for(let n=e.length-1;n>=0;n--){let o=e[n];(void 0!==t&&o.id===t||o.func===t)&&e.splice(n,1)}}l(t[e.ND].listeners.shallow,s),l(t[e.ND].listeners.deep,s)}function c(t,o,r=""){let s=`${t[e.ND].path}${r}`,i=(0,n.splitPath)(r);for(let e of i){if(!t[e])return void console.warn(`can't remove all listeners from a non-existent path '${s}'`);t=t[e]}t[e.ND].listeners.shallow=[],t[e.ND].listeners.deep=[]}function u(e,t){return t.target}function f(e,t){return t}function p(e){return e}function d(){return this}
},{"./global-vars.js":"GM15","./supporting-functions.js":"tgn0","./general-functions.js":"MDxB"}],"NGwh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.initEmitEvent=o,exports.initFunctionEmitEvent=s;var e=require("./global-vars.js"),t=require("./supporting-functions.js");function o(o,s,n,r,d,u){if(n===d||o[e.ND].objects.status!==e.proxyStatuses.ALIVE)return;let p,N,i=e.eventNames.UPDATE;void 0===d?i=e.eventNames.DELETE:void 0===n&&(i=e.eventNames.CREATE),o[e.NID].status===e.nodeStatuses.SPLICING&&(o[e.ND].deferredEvents||(o[e.ND].deferredEvents=[]),p=o[e.ND].deferredEvents),o[s]?(o=o[s],N=""):N=(0,t.property2path)(o[e.ND].objects.target,s);let c={path:N,value:d,oldValue:n,type:i};p?p.push({dataNode:o,change:c,shouldCapture:r||u}):(a(o,c),(r||u)&&l(o,c))}function s(t,o,s,r,d){if(a(t,{path:"",value:d,oldValue:r,type:o,args:s}),t[e.ND].deferredEvents){for(let o of t[e.ND].deferredEvents)""===o.change.path&&(n(o.dataNode[e.ND].listeners.shallow,o.dataNode[e.ND].objects.proxy,o.change),n(o.dataNode[e.ND].listeners.deep,o.dataNode[e.ND].objects.proxy,o.change)),o.shouldCapture&&l(o.dataNode,o.change);delete t[e.ND].deferredEvents}else console.warn(`no side effect events for ${o} were made`)}function a(t,o){if(t[e.NID].status!==e.nodeStatuses.STOPPED&&(""===o.path&&n(t[e.ND].listeners.shallow,t[e.ND].objects.proxy,o),n(t[e.ND].listeners.deep,t[e.ND].objects.proxy,o),!t[e.ND].parentNode.isTreePrototype)){let s={...o,path:t[e.ND].propertyPath+o.path};a(t=t[e.ND].parentNode,s)}}function l(t,o){let s=Object.keys(t);for(let a of s){let s="object"==typeof o.value&&null!==o.value?o.value[a]:void 0,r="object"==typeof o.oldValue&&null!==o.oldValue?o.oldValue[a]:void 0;if(s!==r){let o=e.eventNames.UPDATE;void 0===s?o=e.eventNames.DELETE:void 0===r&&(o=e.eventNames.CREATE);let d={path:"",oldValue:r,value:s,type:o};t[a][e.NID].status!==e.nodeStatuses.STOPPED&&n(t[a][e.ND].listeners.shallow,t[a][e.ND].objects.proxy,d),l(t[a],d)}}}function n(e,t,o){for(let s=e.length-1;s>=0;s--){let a=e[s];a.type.includes(o.type)&&(!0===a.once&&e.splice(s,1),a.func.call(t,o))}}
},{"./global-vars.js":"GM15","./supporting-functions.js":"tgn0"}],"UXyj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.splice=s,exports.shift=r,exports.unshift=a;var t=require("./global-vars.js"),e=require("./event-emitter.js");function s(s,r,a,n,...o){if(s[t.NID].status!==t.nodeStatuses.ACTIVE)return Array.prototype.splice.call(r.proxy,a,n,...o);let u=!s[t.NID].hasOwnProperty("status");s[t.NID].status=t.nodeStatuses.SPLICING;let i=r.target.slice(0),l=Array.prototype.splice.call(r.proxy,a,n,...o),I={start:a,deleteCount:n,items:o};return u?delete s[t.NID].status:s[t.NID].status=t.nodeStatuses.ACTIVE,(0,e.initFunctionEmitEvent)(s,t.eventNames.SPLICE,I,i,r.target),l}function r(s,r){if(s[t.NID].status!==t.nodeStatuses.ACTIVE)return Array.prototype.shift.call(r.proxy);let a=!s[t.NID].hasOwnProperty("status");s[t.NID].status=t.nodeStatuses.SPLICING;let n=r.target.slice(0),o=Array.prototype.shift.call(r.proxy);return a?delete s[t.NID].status:s[t.NID].status=t.nodeStatuses.ACTIVE,(0,e.initFunctionEmitEvent)(s,t.eventNames.SHIFT,{},n,r.target),o}function a(s,r,...a){if(s[t.NID].status!==t.nodeStatuses.ACTIVE)return Array.prototype.shift.call(r.proxy);let n=!s[t.NID].hasOwnProperty("status");s[t.NID].status=t.nodeStatuses.SPLICING;let o=r.target.slice(0),u=Array.prototype.unshift.call(r.proxy,...a),i={items:a};return n?delete s[t.NID].status:s[t.NID].status=t.nodeStatuses.ACTIVE,(0,e.initFunctionEmitEvent)(s,t.eventNames.UNSHIFT,i,o,r.target),u}
},{"./global-vars.js":"GM15","./event-emitter.js":"NGwh"}],"Focm":[function(require,module,exports) {
"use strict";var e=require("./global-vars.js"),t=require("./supporting-functions.js"),r=y(require("./pseudo-methods.js")),o=y(require("./proxy-methods.js")),s=require("./general-functions.js"),i=require("./event-emitter.js");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function y(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var i=o?Object.getOwnPropertyDescriptor(e,s):null;i&&(i.get||i.set)?Object.defineProperty(r,s,i):r[s]=e[s]}return r.default=e,t&&t.set(e,r),r}let n=Symbol.for("proxserve_node_data"),p=Symbol.for("proxserve_node_inherited_data"),l=Object.keys(r);for(let c=l.length-1;c>=0;c--){let e=l[c],t="$"+e;r[t]=r[e],l.push(t)}class u{constructor(r,{strict:o=!0,emitMethods:s=!0,debug:i={}}={}){return this.strict=o,this.emitMethods=s,this.destroyDelay=1e3,i&&i.destroyDelay&&(this.destroyDelay=i.destroyDelay),this.dataTree=(0,t.createDataNode)({[p]:{status:e.nodeStatuses.ACTIVE},[n]:{objects:{status:e.proxyStatuses.ALIVE}},isTreePrototype:!0},""),this.dataTree[n].path="",this.dataTree[n].propertyPath="",this.dataTree[n].objects.target=r,this.createProxy(this.dataTree)}createProxy(a,y){let c;void 0===y?c=a:(c=(0,t.createDataNode)(a,y))[n].objects.target=a[n].objects.target[y];let d=c[n].objects,f=d.target,b=(0,s.realtypeof)(f);if(e.proxyTypes.includes(b)){let a=Proxy.revocable(f,{get:(t,s,i)=>this.emitMethods&&o.hasOwnProperty(s)&&s in Object.getPrototypeOf(t)?o[s].bind(this,c,d):l.includes(s)&&void 0===t[s]?r[s].bind(this,c,d):t.propertyIsEnumerable(s)&&"symbol"!=typeof s&&c[s]&&c[s][n].objects.proxy&&c[s][n].objects.status===e.proxyStatuses.ALIVE?c[s][n].objects.proxy:t[s],set:(r,o,a,y)=>{if(c[p].status===e.nodeStatuses.BLOCKED)return console.error(`can't change value of property '${o}'. object is blocked.`),!0;if("symbol"==typeof o)return r[o]=a,!0;if("length"!==o&&!r.propertyIsEnumerable(o)){let e=Object.getOwnPropertyDescriptor(r,o);if("object"==typeof e&&!1===e.enumerable)return r[o]=a,!0}let l=r[o],d=!1;void 0!==c[o]&&void 0!==c[o][n].objects.proxy&&(c[o][n].objects.status=e.proxyStatuses.DELETED,d=!0,this.strict&&setTimeout(u.destroy,this.destroyDelay,c[o][n].objects.proxy)),a=(0,t.unproxify)(a),r[o]=a;let f=!1,b=(0,s.realtypeof)(a);return e.proxyTypes.includes(b)&&(this.createProxy(c,o),f=!0),(0,i.initEmitEvent)(c,o,l,d,a,f),!0},defineProperty:(r,o,a)=>{if("symbol"==typeof o)return Object.defineProperty(r,o,a),!0;let y=r[o],p=!1;void 0!==c[o]&&void 0!==c[o][n].objects.proxy&&(c[o][n].objects.status=e.proxyStatuses.DELETED,p=!0,this.strict&&setTimeout(u.destroy,this.destroyDelay,c[o][n].objects.proxy)),a.value=(0,t.unproxify)(a.value),Object.defineProperty(r,o,a);let l=a.value,d=!1,f=(0,s.realtypeof)(a.value);return e.proxyTypes.includes(f)&&!0===a.enumerable&&(this.createProxy(c,o),d=!0),(0,i.initEmitEvent)(c,o,y,p,l,d),!0},deleteProperty:(t,r)=>{if(!t.propertyIsEnumerable(r)||"symbol"==typeof r)return delete t[r],!0;if(c[p].status===e.nodeStatuses.BLOCKED)return console.error(`can't delete property '${r}'. object is blocked.`),!0;if(r in t){let o=t[r],s=!1;return void 0!==c[r]&&void 0!==c[r][n].objects.proxy&&(c[r][n].objects.status=e.proxyStatuses.DELETED,s=!0,this.strict&&setTimeout(u.destroy,this.destroyDelay,c[r][n].objects.proxy)),delete t[r],(0,i.initEmitEvent)(c,r,o,s,void 0,!1),!0}return!0}});if(c[n].objects.proxy=a.proxy,c[n].objects.revoke=a.revoke,"Object"===b){let t=Object.keys(f);for(let r of t){let t=(0,s.realtypeof)(f[r]);e.proxyTypes.includes(t)&&this.createProxy(c,r)}}else if("Array"===b)for(let t=0;t<f.length;t++){let r=(0,s.realtypeof)(f[t]);e.proxyTypes.includes(r)&&this.createProxy(c,t)}else console.warn("Not Implemented");return a.proxy}throw new Error("Must observe an "+e.proxyTypes.join("/"))}static destroy(t){let r,o;try{r=t.$getProxserveDataNode(),o=t.$getProxserveObjects()}catch(a){return}o.status===e.proxyStatuses.ALIVE&&(o.status=e.proxyStatuses.DELETED);let i=(0,s.realtypeof)(t);if(e.proxyTypes.includes(i)){let i=Object.keys(t);for(let o of i)try{let i=(0,s.realtypeof)(t[o]);e.proxyTypes.includes(i)&&u.destroy(r[o][n].objects.proxy)}catch(a){console.error(a)}o.revoke(),o.proxy=void 0,o.status=e.proxyStatuses.REVOKED}else console.warn(`Type of "${i}" is not implemented`)}static splitPath(e){return(0,s.splitPath)(e)}static evalPath(e,t){return(0,s.evalPath)(e,t)}}module.exports=exports=u;
},{"./global-vars.js":"GM15","./supporting-functions.js":"tgn0","./pseudo-methods.js":"hyxV","./proxy-methods.js":"UXyj","./general-functions.js":"MDxB","./event-emitter.js":"NGwh"}]},{},["Focm"], "Proxserve")
//# sourceMappingURL=/proxserve.min.js.map