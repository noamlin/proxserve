{"mappings":"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","sources":["src/index.ts","src/globals.ts","src/supporting-functions.ts","src/general-functions.ts","src/pseudo-methods.ts","src/proxy-methods.ts","src/event-emitter.ts"],"sourcesContent":["/**\n * Copyright 2021 Noam Lin <noamlin@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n */\n\"use strict\"\n\nimport { proxyTypes, nodeStatuses, proxyStatuses, ND, NID, SomeProxy, DataNode, ProxyNode, TargetVariable, ProxserveInterface } from './globals';\nimport { unproxify, createNodes } from './supporting-functions';\nimport * as pseudoMethods from './pseudo-methods';\nimport * as proxyMethods from './proxy-methods';\nimport { realtypeof, splitPath, evalPath } from './general-functions';\nimport { initEmitEvent } from './event-emitter';\n\n/**\n * save an array of all reserved function names\n * and also add synonyms to these functions\n */\nlet pseudoMethodsNames = Object.keys(pseudoMethods);\nfor(let i = pseudoMethodsNames.length - 1; i >= 0; i--) {\n\tlet name = pseudoMethodsNames[i];\n\tlet synonym = '$'+name;\n\tpseudoMethods[synonym] = pseudoMethods[name];\n\tpseudoMethodsNames.push(synonym);\n}\n\ninterface ConstructorOptions {\n\tstrict: boolean;\n\temitMethods: boolean;\n\tdebug?: {\n\t\tdestroyDelay: number;\n\t};\n}\n\nexport class Proxserve implements ProxserveInterface {\n\tstrict: boolean;\n\temitMethods: boolean;\n\tdestroyDelay: number;\n\tdataTree: DataNode;\n\tproxyTree: ProxyNode;\n\n\t/**\n\t * construct a new proxserve instance\n\t * @param target \n\t * @param [options]\n\t * \t@property [options.strict] - should destroy detached child-objects or deleted properties automatically\n\t * \t@property [options.emitMethods] - should splice/shift/unshift emit one event or all CRUD events\n\t */\n\tconstructor(target: TargetVariable, options: ConstructorOptions = {} as any) {\n\t\tconst {\n\t\t\tstrict = true,\n\t\t\temitMethods = true,\n\t\t\tdebug = { destroyDelay: 1000 },\n\t\t} = options;\n\n\t\tthis.strict = strict;\n\t\tthis.emitMethods = emitMethods;\n\t\tthis.destroyDelay = debug.destroyDelay;\n\n\t\tlet dataTreePrototype: DataNode = {\n\t\t\t[NID]: { status: nodeStatuses.ACTIVE },\n\t\t\t[ND]: { isTreePrototype: true } as DataNode[typeof ND],\n\t\t};\n\t\tlet proxyTreePrototype: ProxyNode = {\n\t\t\t[NID]: { status: proxyStatuses.ALIVE },\n\t\t\t[ND]: { isTreePrototype: true } as ProxyNode[typeof ND],\n\t\t};\n\n\t\tconst newNodes = createNodes(dataTreePrototype, proxyTreePrototype, '', target);\n\t\tthis.dataTree = newNodes.dataNode;\n\t\tthis.proxyTree = newNodes.proxyNode;\n\n\t\t// `as any` to stop TS from erroring because it wants us to return the `this` object\n\t\t// but instead we are returning a different object\n\t\treturn this.createProxy(this.dataTree) as any;\n\t}\n\n\t/**\n\t * create a new proxy and a new node for a property of the parent's target-object\n\t * @param {Object} parentDataNode\n\t * @param {String} [targetProperty]\n\t */\n\tcreateProxy(parentDataNode: DataNode, targetProperty?: string): SomeProxy {\n\t\tlet parentProxyNode = parentDataNode[ND].proxyNode\n\t\tlet dataNode: DataNode, proxyNode: ProxyNode;\n\n\t\tif(targetProperty === undefined) { //refering to own node and not a child property (meaning root object)\n\t\t\tdataNode = parentDataNode;\n\t\t\tproxyNode = parentProxyNode;\n\t\t}\n\t\telse {\n\t\t\t//creates new or reset an existing data-node and then creates a new proxy-node\n\t\t\tconst newNodes = createNodes(\n\t\t\t\tparentDataNode,\n\t\t\t\tparentProxyNode,\n\t\t\t\ttargetProperty,\n\t\t\t\tparentProxyNode[ND].target[targetProperty],\n\t\t\t);\n\t\t\tdataNode = newNodes.dataNode;\n\t\t\tproxyNode = newNodes.proxyNode;\n\t\t}\n\n\t\tlet target = proxyNode[ND].target;\n\n\t\tlet typeoftarget = realtypeof(target);\n\n\t\tif(proxyTypes[typeoftarget]) {\n\t\t\tlet revocable = Proxy.revocable<TargetVariable>(target, {\n\t\t\t\tget: (target: TargetVariable/*same as parent scope 'target'*/, property: string|symbol, proxy) => {\n\t\t\t\t\tif(this.emitMethods && Object.prototype.hasOwnProperty.call(proxyMethods, property) && property in Object.getPrototypeOf(target)) {\n\t\t\t\t\t\t// use a proxy method instead of the built-in method that is on the prototype chain\n\t\t\t\t\t\treturn proxyMethods[property].bind(this, dataNode, proxyNode);\n\t\t\t\t\t}\n\t\t\t\t\telse if(pseudoMethodsNames.includes(property as string) && typeof target[property] === 'undefined') {\n\t\t\t\t\t\t// can access a pseudo function (or its synonym) if their keywords isn't used\n\t\t\t\t\t\treturn pseudoMethods[property].bind(this, dataNode, proxyNode);\n\t\t\t\t\t}\n\t\t\t\t\telse if(!target.propertyIsEnumerable(property) || typeof property === 'symbol') {\n\t\t\t\t\t\treturn target[property]; // non-enumerable or non-path'able aren't proxied\n\t\t\t\t\t}\n\t\t\t\t\telse if(proxyNode[property] // there's a child node\n\t\t\t\t\t\t\t&& proxyNode[property][ND].proxy // it holds a proxy\n\t\t\t\t\t\t\t&& proxyNode[property][NID].status === proxyStatuses.ALIVE) {\n\t\t\t\t\t\treturn proxyNode[property][ND].proxy;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn target[property];\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\n\t\t\t\tset: (target/*same as parent scope 'target'*/, property, value, proxy) => { //'receiver' is proxy\n\t\t\t\t\t/**\n\t\t\t\t\t * property can be a regular object because of 3 possible reasons:\n\t\t\t\t\t * 1. proxy is deleted from tree but user keeps accessing it then it means he saved a reference\n\t\t\t\t\t * 2. it is a non-enumerable property which means it was intentionally hidden\n\t\t\t\t\t * 3. property is a symbol and symbols can't be proxied because we can't create a normal path for them.\n\t\t\t\t\t *    these properties are not proxied and should not emit change-event.\n\t\t\t\t\t *    except for: length\n\t\t\t\t\t * TODO - make a list of all possible properties exceptions (maybe function 'name'?)\n\t\t\t\t\t */\n\t\t\t\t\tif(dataNode[NID].status === nodeStatuses.BLOCKED) { //blocked from changing values\n\t\t\t\t\t\tconsole.error('object is blocked. can\\'t change value of property:', property);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse if(typeof property === 'symbol') {\n\t\t\t\t\t\ttarget[property] = value;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse if(property !== 'length' && !target.propertyIsEnumerable(property)) {\n\t\t\t\t\t\t//if setting a whole new property then it is non-enumerable (yet) so a further test is needed\n\t\t\t\t\t\tlet descriptor = Object.getOwnPropertyDescriptor(target, property);\n\t\t\t\t\t\tif(typeof descriptor === 'object' && descriptor.enumerable === false) { //property was previously set\n\t\t\t\t\t\t\ttarget[property] = value;\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet oldValue = target[property]; // should not be proxy\n\t\t\t\t\tlet isOldValueProxy = false;\n\t\t\t\t\tif(proxyNode[property] !== undefined && proxyNode[property][ND].proxy !== undefined) {\n\t\t\t\t\t\t// about to overwrite an existing property which is a proxy (about to detach a proxy)\n\t\t\t\t\t\tproxyNode[property][NID].status = proxyStatuses.DELETED;\n\t\t\t\t\t\tdelete dataNode[property][ND].proxyNode; // detach reference from data-node to proxy-node\n\t\t\t\t\t\tisOldValueProxy = true;\n\t\t\t\t\t\tif(this.strict) {\n\t\t\t\t\t\t\t// postpone this cpu intense function for later, probably when proxserve is not in use\n\t\t\t\t\t\t\tsetTimeout(Proxserve.destroy, this.destroyDelay, proxyNode[property][ND].proxy); \n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvalue = unproxify(value);\n\t\t\t\t\ttarget[property] = value; //assign new value\n\n\t\t\t\t\tlet isValueProxy = false;\n\t\t\t\t\tlet typeofvalue = realtypeof(value);\n\t\t\t\t\tif(proxyTypes[typeofvalue]) {\n\t\t\t\t\t\tthis.createProxy(dataNode, property); //if trying to add a new value which is an object then make it a proxy\n\t\t\t\t\t\tisValueProxy = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinitEmitEvent(dataNode, property, oldValue, isOldValueProxy, value, isValueProxy);\n\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * TODO - this function is incomplete and doesn't handle all of 'descriptor' scenarios\n\t\t\t\t */\n\t\t\t\tdefineProperty: (target/*same as parent scope 'target'*/, property, descriptor) => {\n\t\t\t\t\tif(typeof property === 'symbol') {\n\t\t\t\t\t\tObject.defineProperty(target, property, descriptor);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet oldValue = target[property]; //should not be proxy\n\t\t\t\t\tlet isOldValueProxy = false;\n\t\t\t\t\tif(proxyNode[property] !== undefined && proxyNode[property][ND].proxy !== undefined) {\n\t\t\t\t\t\t//about to overwrite an existing property which is a proxy (about to detach a proxy)\n\t\t\t\t\t\tproxyNode[property][NID].status = proxyStatuses.DELETED;\n\t\t\t\t\t\tdelete dataNode[property][ND].proxyNode; //detach reference from data-node to proxy-node\n\t\t\t\t\t\tisOldValueProxy = true;\n\t\t\t\t\t\tif(this.strict) {\n\t\t\t\t\t\t\t//postpone this cpu intense function for later, probably when proxserve is not is use\n\t\t\t\t\t\t\tsetTimeout(Proxserve.destroy, this.destroyDelay, proxyNode[property][ND].proxy);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tdescriptor.value = unproxify(descriptor.value);\n\t\t\t\t\tObject.defineProperty(target, property, descriptor); //defining the new value\n\t\t\t\t\tlet value = descriptor.value;\n\t\t\t\t\tlet isValueProxy = false;\n\t\t\t\t\t//excluding non-enumerable properties from being proxied\n\t\t\t\t\tlet typeofvalue = realtypeof(descriptor.value);\n\t\t\t\t\tif(proxyTypes[typeofvalue] && descriptor.enumerable === true) {\n\t\t\t\t\t\tthis.createProxy(dataNode, property); //if trying to add a new value which is an object then make it a proxy\n\t\t\t\t\t\tisValueProxy = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinitEmitEvent(dataNode, property, oldValue, isOldValueProxy, value, isValueProxy);\n\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\n\t\t\t\tdeleteProperty: (target/*same as parent scope 'target'*/, property) => {\n\t\t\t\t\tif(!target.propertyIsEnumerable(property) || typeof property === 'symbol') {\n\t\t\t\t\t\t//non-proxied properties simply get deleted and nothing more\n\t\t\t\t\t\tdelete target[property];\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(dataNode[NID].status === nodeStatuses.BLOCKED) { //blocked from changing values\n\t\t\t\t\t\tconsole.error(`can't delete property '${property}'. object is blocked.`);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(property in target) {\n\t\t\t\t\t\tlet oldValue = target[property]; //should not be proxy\n\t\t\t\t\t\tlet isOldValueProxy = false;\n\t\t\t\t\t\tif(proxyNode[property] !== undefined && proxyNode[property][ND].proxy !== undefined) {\n\t\t\t\t\t\t\t//about to overwrite an existing property which is a proxy (about to detach a proxy)\n\t\t\t\t\t\t\tproxyNode[property][NID].status = proxyStatuses.DELETED;\n\t\t\t\t\t\t\tdelete dataNode[property][ND].proxyNode; //detach reference from data-node to proxy-node\n\t\t\t\t\t\t\tisOldValueProxy = true;\n\t\t\t\t\t\t\tif(this.strict) {\n\t\t\t\t\t\t\t\t//postpone this cpu intense function for later, probably when proxserve is not is use\n\t\t\t\t\t\t\t\tsetTimeout(Proxserve.destroy, this.destroyDelay, proxyNode[property][ND].proxy);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdelete target[property]; //actual delete\n\n\t\t\t\t\t\tinitEmitEvent(dataNode, property, oldValue, isOldValueProxy, undefined, false);\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn true; //do nothing because there's nothing to delete\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} as ProxyHandler<TargetVariable>) as { proxy: SomeProxy, revoke: ()=>void };\n\n\t\t\tproxyNode[ND].proxy = revocable.proxy;\n\t\t\tproxyNode[ND].revoke = revocable.revoke;\n\n\t\t\tif(proxyTypes[typeoftarget]) {\n\t\t\t\tlet keys = Object.keys(target); //handles both Objects and Arrays\n\t\t\t\tfor(let key of keys) {\n\t\t\t\t\tlet typeofproperty = realtypeof(target[key]);\n\t\t\t\t\tif(proxyTypes[typeofproperty]) {\n\t\t\t\t\t\tthis.createProxy(dataNode, key); //recursively make child objects also proxies\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconsole.warn(`Type of \"${typeoftarget}\" is not implemented`);\n\t\t\t}\n\n\t\t\treturn revocable.proxy;\n\t\t}\n\t\telse {\n\t\t\tconst types = Object.keys(proxyTypes);\n\t\t\tthrow new Error(`Must observe an ${types.join('/')}`);\n\t\t}\n\t}\n\n\t/**\n\t * Recursively revoke proxies, allowing them to be garbage collected.\n\t * this functions delays 1000 milliseconds to let time for all events to finish\n\t * @param {*} proxy \n\t */\n\tstatic destroy(proxy) {\n\t\tlet proxyNode;\n\t\ttry {\n\t\t\t[, proxyNode] = proxy.$getProxserveNodes();\n\t\t} catch(error) {\n\t\t\treturn; // proxy variable isn't a proxy\n\t\t}\n\n\t\tif(proxyNode[NID].status === proxyStatuses.ALIVE) {\n\t\t\tproxyNode[NID].status = proxyStatuses.DELETED;\n\t\t}\n\n\t\tlet typeofproxy = realtypeof(proxy);\n\n\t\tif(proxyTypes[typeofproxy]) {\n\t\t\tlet keys = Object.keys(proxy); // handles both Objects and Arrays\n\t\t\tfor(let key of keys) {\n\t\t\t\ttry {\n\t\t\t\t\tlet typeofproperty = realtypeof(proxy[key]);\n\t\t\t\t\tif(proxyTypes[typeofproperty]) {\n\t\t\t\t\t\t// going to proxy[key], which is deleted, will return the original target so we will bypass it\n\t\t\t\t\t\tProxserve.destroy(proxyNode[key][ND].proxy);\n\t\t\t\t\t}\n\t\t\t\t} catch(error) {\n\t\t\t\t\tconsole.error(error); // don't throw and kill the whole process just if this iteration fails\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tproxyNode[ND].revoke();\n\t\t\t//proxyNode[ND].proxy = undefined;\n\t\t\tproxyNode[NID].status = proxyStatuses.REVOKED;\n\t\t}\n\t\telse {\n\t\t\tconsole.warn(`Type of \"${typeofproxy}\" is not implemented`);\n\t\t}\n\t}\n\n\tstatic splitPath(path) {\n\t\treturn splitPath(path);\n\t}\n\n\tstatic evalPath(obj, path) {\n\t\treturn evalPath(obj, path);\n\t}\n}","/**\n * Copyright 2021 Noam Lin <noamlin@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n */\n\"use strict\"\n\nexport const ND = Symbol.for('proxserve_node_data'); // key for the data of a node\nexport const NID = Symbol.for('proxserve_node_inherited_data'); // key for the inherited data of a node\n\n// acceptable types to be proxied\nexport const proxyTypes = {\n\t\"Object\": true,\n\t\"Array\": true,\n};\n\n// statuses of data-nodes\nexport enum nodeStatuses {\n\tACTIVE = 'active',\n\tSTOPPED = 'stopped',\n\tBLOCKED = 'blocked',\n\tSPLICING = 'splicing',\n};\n\n// statuses of proxies\nexport enum proxyStatuses {\n\tALIVE = 'alive',\n\tDELETED = 'deleted',\n\tREVOKED = 'revoked',\n};\n\n// event names that can be emitted\nexport enum eventNames {\n\tcreate = 'create',\n\tupdate = 'update',\n\tdelete = 'delete',\n\tsplice = 'splice',\n\tshift = 'shift',\n\tunshift = 'unshift',\n};\n\nexport type SomeObject = {\n\t[key: string | number | symbol]: any,\n};\nexport type SomeProxy = {\n\t[ND]: ProxyNode[typeof ND],\n\t[NID]: ProxyNode[typeof NID],\n\t[property: string]: any,\n};\nexport type SomeArray = Array<any>;\nexport type TargetVariable = SomeObject | SomeArray;\n\n// theoretically can have any string possible as a type. but these are the most common and they help our TS autocomplete\nexport type variableTypes = 'Object'|'Array'|'Number'|'String'|'Boolean'|'Null'|'Undefined'|'BigInt'|'Symbol'|'Date';\n\nexport type ListenerData = {\n\ttype: eventNames[],\n\tonce: boolean,\n\tfunc: Function,\n\tid?: string | number;\n};\n\nexport type DeferredEvent = {\n\tdataNode: DataNode,\n\tchange: ChangeEvent,\n\tshouldCapture: boolean,\n};\n\nexport type ChangeEvent = {\n\tpath: string,\n\tvalue: any,\n\toldValue: any,\n\ttype: eventNames,\n\targs?: {\n\t\tstart?: number;\n\t\tdeleteCount?: number;\n\t\titems?: any[];\n\t},\n};\n\nexport interface DataNode {\n\t// Node Inherited Data\n\t[NID]: {\n\t\tstatus?: nodeStatuses;\n\t};\n\t// Node Data\n\t[ND]: {\n\t\tproxyNode: ProxyNode;\n\t\tparentNode: DataNode;\n\t\tlisteners: {\n\t\t\tshallow: ListenerData[];\n\t\t\tdeep: ListenerData[];\n\t\t},\n\t\tpath: string;\n\t\tpropertyPath: string;\n\t\tdeferredEvents?: DeferredEvent[];\n\t\tisTreePrototype?: boolean;\n\t};\n};\n\nexport interface ProxyNode {\n\t[NID]: {\n\t\tstatus?: proxyStatuses;\n\t};\n\t[ND]: {\n\t\ttarget: TargetVariable;\n\t\tdataNode: DataNode;\n\t\tproxy?: SomeProxy;\n\t\trevoke?: () => void;\n\t\tisTreePrototype?: boolean;\n\t};\n\t[property: string]: ProxyNode;\n};\n\nexport interface ProxserveInterface {\n\tstrict: boolean;\n\temitMethods: boolean;\n\tdestroyDelay: number;\n\tdataTree: DataNode;\n\tproxyTree: ProxyNode;\n\tcreateProxy(parentDataNode: DataNode, targetProperty?: string): SomeProxy;\n}","/**\n * Copyright 2021 Noam Lin <noamlin@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n */\n\"use strict\"\n\nimport { proxyTypes, ND, NID, DataNode, ProxyNode, TargetVariable } from './globals';\nimport { realtypeof } from './general-functions';\n\n/**\n * Convert property name to valid path segment\n */\nexport function property2path(obj: any, property: string|number): string {\n\tif(typeof property === 'symbol') {\n\t\tthrow new Error(`property of type \"symbol\" isn't path'able`);\n\t}\n\n\tconst typeofobj = realtypeof(obj);\n\tswitch(typeofobj) {\n\t\tcase 'Object': {\n\t\t\treturn `.${property}`;\n\t\t}\n\t\tcase 'Array': {\n\t\t\treturn `[${property}]`;\n\t\t}\n\t\tdefault: {\n\t\t\tconsole.warn(`Not Implemented (type of '${typeofobj}')`);\n\t\t\treturn property as string;\n\t\t}\n\t}\n}\n\n/**\n * recursively switch between all proxies to their original targets.\n * note: original targets should never hold proxies under them,\n * thus altering the object references (getting from 'value') should be ok.\n * if whoever uses this library decides to\n * \t1. create a proxy with children (sub-proxies)\n * \t2. create a regular object\n * \t3. adding sub-proxies to the regular object\n * \t4. attaching the regular object to the proxy\n * then this regular object will be altered.\n */\nexport function unproxify(value: any): any {\n\tconst typeofvalue = realtypeof(value);\n\n\tif(proxyTypes[typeofvalue]) {\n\t\tlet target = value;\n\t\ttry {\n\t\t\ttarget = value.$getOriginalTarget();\n\t\t} catch(error) {}\n\n\t\tswitch(typeofvalue) {\n\t\t\tcase 'Object':\n\t\t\t\tlet keys = Object.keys(target);\n\t\t\t\tfor(let key of keys) {\n\t\t\t\t\ttarget[key] = unproxify(target[key]); // maybe alters target and maybe returning the exact same object\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Array':\n\t\t\t\tfor(let i=0; i < target.length; i++) {\n\t\t\t\t\ttarget[i] = unproxify(target[i]); // maybe alters target and maybe returning the exact same object\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn(`Not Implemented (type of '${typeofvalue}')`);\n\t\t}\n\n\t\treturn target;\n\t}\n\telse {\n\t\treturn value; // primitive\n\t}\n}\n\n/**\n * create or reset a node in a tree of meta-data (mainly path related)\n * and optionally create a node in a tree of proxy data (mainly objects related)\n */\nexport function createNodes(\n\tparentDataNode: DataNode,\n\tparentProxyNode: ProxyNode | undefined,\n\tproperty: string | number,\n\ttarget: TargetVariable | undefined,\n): { dataNode: DataNode, proxyNode: ProxyNode } {\n\t//handle property path\n\tlet propertyPath: string;\n\tif(parentProxyNode?.[ND].target) {\n\t\tpropertyPath = property2path(parentProxyNode[ND].target, property);\n\t} else {\n\t\tpropertyPath = property2path({}, property); // if parent doesn't have target then treat it as object\n\t}\n\t\n\t//handle data node\n\tlet dataNode: DataNode = parentDataNode[property]; // try to receive existing data-node\n\tif(!dataNode) {\n\t\tdataNode = {\n\t\t\t[NID]: Object.create(parentDataNode[NID]),\n\t\t\t[ND]: {\n\t\t\t\tparentNode: parentDataNode,\n\t\t\t\tlisteners: {\n\t\t\t\t\tshallow: [],\n\t\t\t\t\tdeep: []\n\t\t\t\t},\n\t\t\t}\n\t\t} as DataNode;\n\t\tparentDataNode[property] = dataNode;\n\t}\n\n\tdelete dataNode[NID].status; // clears old status in case a node previously existed\n\t// updates path (for rare case where parent was array and then changed to object or vice versa)\n\tif(!parentDataNode[ND].isTreePrototype) {\n\t\tObject.assign(dataNode[ND], {\n\t\t\tpath: parentDataNode[ND].path + propertyPath,\n\t\t\tpropertyPath\n\t\t});\n\t}\n\telse {\n\t\tObject.assign(dataNode[ND], {\n\t\t\tpath: '',\n\t\t\tpropertyPath: ''\n\t\t});\n\t}\n\n\t//handle proxy node\n\tlet proxyNode: ProxyNode;\n\tif(parentProxyNode) {\n\t\tproxyNode = {\n\t\t\t[NID]: Object.create(parentProxyNode[NID]),\n\t\t\t[ND]: {\n\t\t\t\ttarget,\n\t\t\t\tdataNode,\n\t\t\t},\n\t\t};\n\n\t\tparentProxyNode[property] = proxyNode;\n\n\t\t//attach nodes to each other\n\t\tdataNode[ND].proxyNode = proxyNode;\n\t}\n\n\treturn { dataNode, proxyNode };\n}\n","/**\n * Copyright 2021 Noam Lin <noamlin@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n */\n\"use strict\"\n\nimport { SomeObject, SomeArray, variableTypes } from './globals';\n\n/**\n * return a string representing the full type of the variable\n */\nexport function realtypeof(variable: any): variableTypes {\n\tlet rawType = Object.prototype.toString.call(variable); //[object Object], [object Array], [object Number]...\n\treturn rawType.substring(8, rawType.length - 1);\n}\n\n/**\n * check if variable is a number or a string of a number\n * @param variable \n */\n/*export function isNumeric(variable: any): boolean {\n\tif(typeof variable === 'string' && variable === '') {\n\t\treturn false;\n\t}\n\t\n\treturn !isNaN(variable as number);\n}*/\n\n/**\n * recursively clones objects and array\n */\nconst simpleCloneSet = new WeakSet();\nexport function simpleClone(variable: any): any {\n\tlet typeofvar = realtypeof(variable);\n\n\tif(typeofvar === 'Object') {\n\t\tconst obj = variable as SomeObject;\n\t\tsimpleCloneSet.add(obj);\n\t\tconst cloned = {};\n\t\tlet keys = Object.keys(obj);\n\t\tfor(let key of keys) {\n\t\t\tif(simpleCloneSet.has(obj[key])) {\n\t\t\t\tcloned[key] = obj[key];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcloned[key] = simpleClone(obj[key]);\n\t\t\t}\n\t\t}\n\t\treturn cloned;\n\t}\n\telse if(typeofvar === 'Array') {\n\t\tconst arr = variable as SomeArray;\n\t\tsimpleCloneSet.add(arr);\n\t\tconst cloned = [];\n\t\tfor(let i = 0; i < arr.length; i++) {\n\t\t\tif(simpleCloneSet.has(arr[i])) {\n\t\t\t\tcloned[i] = arr[i];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcloned[i] = simpleClone(arr[i]);\n\t\t\t}\n\t\t}\n\t\treturn cloned;\n\t}\n\telse { // hopefully a primitive\n\t\tif(typeofvar !== 'Undefined' && typeofvar !== 'Null' && typeofvar !== 'Boolean' && typeofvar !== 'Number'\n\t\t&& typeofvar !== 'BigInt' && typeofvar !== 'String') {\n\t\t\tconsole.warn(`Can't clone a variable of type ${typeofvar}`);\n\t\t}\n\t\treturn variable;\n\t}\n}\n\n/**\n * splits a path to an array of properties\n * (benchmarked and is faster than regex and split())\n * @param path \n */\nexport function splitPath(path: string): Array<string|number> {\n\tif(typeof path !== 'string' || path === '') {\n\t\treturn [];\n\t}\n\t\n\tlet i = 0, betweenBrackets = false, onlyDigits = false;\n\t//loop will skip over openning '.' or '['\n\tif(path[0] === '.') {\n\t\ti = 1;\n\t} else if(path[0] === '[') {\n\t\ti = 1;\n\t\tbetweenBrackets = true;\n\t\tonlyDigits = true;\n\t}\n\n\tlet resultsArr = [] as Array<string|number>;\n\tlet tmp = '';\n\tfor(; i < path.length; i++) {\n\t\tlet char = path[i];\n\n\t\tif(betweenBrackets) {\n\t\t\tif(char === ']') {\n\t\t\t\tif(onlyDigits) {\n\t\t\t\t\tresultsArr.push(parseInt(tmp, 10));\n\t\t\t\t} else {\n\t\t\t\t\tresultsArr.push(tmp);\n\t\t\t\t}\n\n\t\t\t\tbetweenBrackets = false;\n\t\t\t\tonlyDigits = false;\n\t\t\t\ttmp = '';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(onlyDigits) {\n\t\t\t\t\tlet code = char.charCodeAt(0);\n\t\t\t\t\tif(code < 48 || code > 57) { //less than '0' char or greater than '9' char\n\t\t\t\t\t\tonlyDigits = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp += char;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif(char === '[') {\n\t\t\t\tbetweenBrackets = true;\n\t\t\t\tonlyDigits = true;\n\t\t\t}\n\t\t\t\n\t\t\t//check if starting a new property but avoid special case of [prop][prop]\n\t\t\tif(char === '.' || char === '[') {\n\t\t\t\tif(tmp !== '') {\n\t\t\t\t\tresultsArr.push(tmp);\n\t\t\t\t\ttmp = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttmp += char;\n\t\t\t}\n\t\t}\n\t}\n\tif(tmp !== '') {\n\t\tresultsArr.push(tmp);\n\t}\n\treturn resultsArr;\n}\n\n/**\n * evaluate a long path and return the designated object and its referred property\n */\nexport function evalPath(obj: SomeObject, path: string): {\n\tobject: SomeObject,\n\tproperty: string|number,\n\tvalue: any,\n} {\n\tif(path === '') {\n\t\treturn {\n\t\t\tobject: obj,\n\t\t\tproperty: undefined,\n\t\t\tvalue: obj,\n\t\t};\n\t}\n\n\tlet segments = splitPath(path);\n\tlet i: number;\n\tfor(i = 0; i <= segments.length - 2; i++) { //iterate until one before last property because they all must exist\n\t\tobj = obj[segments[i]];\n\t\tif(typeof obj === 'undefined') {\n\t\t\tthrow new Error(`Invalid path was given - \"${path}\"`);\n\t\t}\n\t}\n\treturn {\n\t\tobject: obj,\n\t\tproperty: segments[i],\n\t\tvalue: obj[ segments[i] ],\n\t};\n}","/**\n * Copyright 2021 Noam Lin <noamlin@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n */\n// Pseudo methods are methods that aren't really on the object - not as a property nor via its prototype\n// thus they will not be retrieved via \"for..in\" and etcetera. Their property name is actually undefined, but\n// calling it will return the method via the JS proxy's \"get\" handler.\n// (i.e. someProxserve.pseudoFunction will return the pseudoFunction)\n\"use strict\"\n\nimport { eventNames, nodeStatuses, ND, NID, DataNode, ProxyNode, ListenerData, TargetVariable, ProxserveInterface } from './globals';\nimport { createNodes } from './supporting-functions';\nimport { splitPath } from './general-functions';\n\n/**\n * stop object and children from emitting change events\n * automatically filled param {Object} dataNode\n */\nexport function stop(dataNode: DataNode): void {\n\tdataNode[NID].status = nodeStatuses.STOPPED;\n}\n\n/**\n * block object and children from any changes.\n * user can't set nor delete any property\n * automatically filled param {Object} dataNode\n */\nexport function block(dataNode: DataNode): void {\n\tdataNode[NID].status = nodeStatuses.BLOCKED;\n}\n\n/**\n * resume default behavior of emitting change events, inherited from parent\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n * @param {Boolean} [force] - force being active regardless of parent\n */\nexport function activate(dataNode: DataNode, proxyNode: ProxyNode, force=false): void {\n\tif(force || dataNode === this.dataTree) { //force activation or we are on root proxy\n\t\tdataNode[NID].status = nodeStatuses.ACTIVE;\n\t}\n\telse {\n\t\tdelete dataNode[NID].status;\n\t}\n}\n\ninterface OnOptions {\n\tdeep?: boolean;\n\tid?: number | string;\n\tonce?: boolean;\n}\n/**\n * add event listener on a proxy or on a descending path\n * \n * @remarks\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n * \n * @param events\n * @param [path] - path selector\n * @param listener\n * @param [options]\n * \t@property [options.deep] - should listen for event emitted by sub-objects or not\n * \t@property [options.id] - identifier for removing this listener later\n * \t@property [options.once] - whether this listener will run only once or always\n */\nexport function on(\n\tdataNode: DataNode,\n\tproxyNode: ProxyNode,\n\tevents: eventNames | eventNames[],\n\tpath: string,\n\tlistener: Function,\n\toptions?: OnOptions,\n) {\n\tlet {\n\t\tdeep = false,\n\t\tid = undefined,\n\t\tonce = false\n\t} = options;\n\n\tif((events as string) === 'change') {\n\t\tevents = Object.keys(eventNames) as eventNames[]; // will listen to all events\n\t} else if(!Array.isArray(events)) {\n\t\tevents = [events];\n\t}\n\n\tfor(let event of events) {\n\t\tif(!eventNames[event]) {\n\t\t\tconst names = Object.keys(eventNames);\n\t\t\tthrow new Error(`${event} is not a valid event. valid events are ${names.join(',')}`);\n\t\t}\n\t}\n\n\tif(typeof path === 'function') { // if called without path\n\t\tif(typeof listener === 'object') { // listener is options\n\t\t\tconst optionsFromListener = listener as OnOptions;\n\t\t\tif(typeof optionsFromListener.deep === 'boolean') {\n\t\t\t\tdeep = optionsFromListener.deep;\n\t\t\t}\n\t\t\tif(optionsFromListener.id !== undefined) {\n\t\t\t\tid = optionsFromListener.id;\n\t\t\t}\n\t\t\tif(typeof optionsFromListener.once === 'boolean') {\n\t\t\t\tonce = optionsFromListener.once;\n\t\t\t}\n\t\t}\n\t\tlistener = path as Function;\n\t\tpath = '';\n\t} else if(typeof listener !== 'function') {\n\t\tthrow new Error(`invalid arguments were given. listener must be a function`);\n\t}\n\t\n\tlet segments = splitPath(path);\n\tfor(let property of segments) { // traverse down the tree\n\t\tif(!dataNode[property]) { // create data-nodes if needed\n\t\t\tcreateNodes(dataNode, undefined, property, undefined);\n\t\t}\n\n\t\tdataNode = dataNode[property];\n\t}\n\n\tlet listenersPool = dataNode[ND].listeners.shallow;\n\tif(deep) {\n\t\tlistenersPool = dataNode[ND].listeners.deep;\n\t}\n\n\tlet listenerObj = {\n\t\ttype: events,\n\t\tonce: once,\n\t\tfunc: listener\n\t} as ListenerData;\n\n\tif(id !== undefined) {\n\t\tlistenerObj.id = id;\n\t}\n\tlistenersPool.push(listenerObj);\n}\n\n/**\n * just like `on` but the listener will run only once\n * @see on() function\n */\nexport function once(\n\tdataNode: DataNode,\n\tproxyNode: ProxyNode,\n\tevents: eventNames | eventNames[],\n\tpath: string,\n\tlistener: Function,\n\toptions?: OnOptions): void {\n\tif(typeof options !== 'object') {\n\t\toptions = {};\n\t}\n\toptions.once = true;\n\ton.call(this, dataNode, proxyNode, events, path, listener, options);\n}\n\nfunction removeById(listenersArr: ListenerData[], id: string | number | Function): void {\n\tfor(let i = listenersArr.length - 1; i >= 0; i--) {\n\t\tlet listenerObj = listenersArr[i];\n\t\tif((id !== undefined && listenerObj.id === id) || listenerObj.func === id) {\n\t\t\tlistenersArr.splice(i, 1);\n\t\t}\n\t}\n}\n\n/**\n * removes a listener from a path by an identifier (can have multiple listeners with the same ID)\n * or by the listener function itself\n * \n * @remarks\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n * \n * @param [path] - path selector\n * @param id - the listener(s) identifier or listener-function\n */\nexport function removeListener(dataNode: DataNode, proxyNode: ProxyNode, path: string, id: string | number | Function): void {\n\tif(arguments.length === 3) { // if called without path\n\t\tid = path as string | number | Function;\n\t\tpath = '';\n\t}\n\n\tlet fullPath = `${dataNode[ND].path}${path}`;\n\tlet segments = splitPath(path);\n\t// traverse down the tree\n\tfor(let property of segments) {\n\t\tif(!dataNode[property]) {\n\t\t\tconsole.warn(`can't remove listener from a non-existent path '${fullPath}'`);\n\t\t\treturn;\n\t\t}\n\t\tdataNode = dataNode[property];\n\t}\n\n\tremoveById(dataNode[ND].listeners.shallow, id);\n\tremoveById(dataNode[ND].listeners.deep, id);\n}\n\n/**\n * removing all listeners of a path\n * \n * @remarks\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n * \n * @param [path] - path selector\n */\nexport function removeAllListeners(dataNode: DataNode, proxyNode: ProxyNode, path = '') {\n\tlet fullPath = `${dataNode[ND].path}${path}`;\n\tlet segments = splitPath(path);\n\t//traverse down the tree\n\tfor(let property of segments) {\n\t\tif(!dataNode[property]) {\n\t\t\tconsole.warn(`can't remove all listeners from a non-existent path '${fullPath}'`);\n\t\t\treturn;\n\t\t}\n\t\tdataNode = dataNode[property];\n\t}\n\n\tdataNode[ND].listeners.shallow = [] as ListenerData[];\n\tdataNode[ND].listeners.deep = [] as ListenerData[];\n}\n\n/**\n * the following functions (getOriginalTarget, getProxserveNodes, getProxserveInstance) seem silly\n * because they could have been written directly on the handler's get() method but it's here as part of the convention of\n * exposing proxy-\"inherited\"-methods\n */\n/**\n * get original target that is behind the proxy\n * \n * @remarks\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n */\nexport function getOriginalTarget(dataNode: DataNode, proxyNode: ProxyNode): TargetVariable {\n\treturn proxyNode[ND].target;\n}\n\n/**\n * get the data-node of a proxy (which holds all meta data)\n * and also get proxy-node of a proxy (which holds all related objects)\n * \n * @remarks\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n */\nexport function getProxserveNodes(dataNode: DataNode, proxyNode: ProxyNode): {\n\tdataNode: DataNode;\n\tproxyNode: ProxyNode;\n} {\n\treturn { dataNode, proxyNode };\n}\n\n/**\n * get the Proxserve's instance that created this proxy\n */\nexport function getProxserveInstance(): ProxserveInterface {\n\treturn (this as ProxserveInterface);\n}","/**\n * Copyright 2021 Noam Lin <noamlin@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n */\n// Proxy methods are methods that will proxy JS built-in methods.\n// For examply, the proxy function for \"splice\" will handle some event stuff and then use\n// the actual \"splice\" function internally\n\"use strict\"\n\nimport { nodeStatuses, eventNames, ND, NID, DataNode, ProxyNode } from './globals';\nimport { initFunctionEmitEvent } from './event-emitter';\n\n/**\n * a wrapper function for the 'splice' method\n * \n * @remarks\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n * \n * @param start \n * @param deleteCount \n * @param items - rest of arguments\n */\nexport function splice(\n\tdataNode: DataNode,\n\tproxyNode: ProxyNode,\n\tstart: number,\n\tdeleteCount: number,\n\t...items: any[]\n): any[] {\n\tif(dataNode[NID].status !== nodeStatuses.ACTIVE) {\n\t\treturn Array.prototype.splice.call(proxyNode[ND].proxy, start, deleteCount, ...items);\n\t}\n\n\tlet isActiveByInheritance = !dataNode[NID].hasOwnProperty('status');\n\tdataNode[NID].status = nodeStatuses.SPLICING;\n\tlet oldValue = proxyNode[ND].target.slice(0);\n\tlet deleted = Array.prototype.splice.call(proxyNode[ND].proxy, start, deleteCount, ...items); // creates many side-effect events\n\tlet args = { start, deleteCount, items };\n\t\n\tif(isActiveByInheritance) {\n\t\tdelete dataNode[NID].status;\n\t} else {\n\t\tdataNode[NID].status = nodeStatuses.ACTIVE;\n\t}\n\n\tinitFunctionEmitEvent(dataNode, eventNames.splice, args, oldValue, proxyNode[ND].target);\n\n\treturn deleted;\n}\n\n/**\n * a wrapper function for the 'shift' method\n * \n * @remarks\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n */\nexport function shift(dataNode: DataNode, proxyNode: ProxyNode): any {\n\tif(dataNode[NID].status !== nodeStatuses.ACTIVE) {\n\t\t// if not active then run regular `shift`\n\t\t// which will reach the `set` of the ProxyHandler and will be blocked or events stopped, etc.\n\t\treturn Array.prototype.shift.call(proxyNode[ND].proxy);\n\t}\n\n\tlet isActiveByInheritance = !dataNode[NID].hasOwnProperty('status');\n\tdataNode[NID].status = nodeStatuses.SPLICING;\n\tlet oldValue = proxyNode[ND].target.slice(0);\n\tlet deleted = Array.prototype.shift.call(proxyNode[ND].proxy); // creates many side-effect events\n\t\n\tif(isActiveByInheritance) {\n\t\tdelete dataNode[NID].status;\n\t} else {\n\t\tdataNode[NID].status = nodeStatuses.ACTIVE;\n\t}\n\n\tinitFunctionEmitEvent(dataNode, eventNames.shift, {}, oldValue, proxyNode[ND].target);\n\n\treturn deleted;\n}\n\n/**\n * a wrapper function for the 'unshift' method\n * \n * @remarks\n * automatically filled param {Object} dataNode\n * automatically filled param {Object} proxyNode\n * \n * @param items \n */\nexport function unshift(dataNode: DataNode, proxyNode: ProxyNode, ...items: any[]): number {\n\tif(dataNode[NID].status !== nodeStatuses.ACTIVE) {\n\t\treturn Array.prototype.shift.call(proxyNode[ND].proxy) as number;\n\t}\n\n\tlet isActiveByInheritance = !dataNode[NID].hasOwnProperty('status');\n\tdataNode[NID].status = nodeStatuses.SPLICING;\n\tlet oldValue = proxyNode[ND].target.slice(0);\n\tlet newLength: number = Array.prototype.unshift.call(proxyNode[ND].proxy, ...items); // creates many side-effect events\n\tlet args = { items };\n\t\n\tif(isActiveByInheritance) {\n\t\tdelete dataNode[NID].status;\n\t} else {\n\t\tdataNode[NID].status = nodeStatuses.ACTIVE;\n\t}\n\n\tinitFunctionEmitEvent(dataNode, eventNames.unshift, args, oldValue, proxyNode[ND].target);\n\n\treturn newLength;\n}\n","/**\n * Copyright 2021 Noam Lin <noamlin@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n */\n\"use strict\"\n\nimport { eventNames, nodeStatuses, proxyStatuses, ND, NID, DataNode, ChangeEvent, DeferredEvent, ListenerData } from './globals';\nimport { property2path } from './supporting-functions';\nimport { splitPath } from './general-functions';\n\n/**\n * try to get the proxy-object from a data-node. if can't then from it's parent's proxy\n * @param dataNode \n * @param [property] - the property as the dataNode is assigned on its parent\n */\nfunction getProxyValue(dataNode: DataNode, property?: string): any {\n\tif(dataNode[ND].proxyNode && dataNode[ND].proxyNode[NID].status === proxyStatuses.ALIVE) {\n\t\treturn dataNode[ND].proxyNode[ND].proxy; // actual proxy of child node\n\t}\n\telse {\n\t\tif(!property) {\n\t\t\t// my property on the parent\n\t\t\tproperty = splitPath(dataNode[ND].propertyPath)[0] as string;\n\t\t}\n\n\t\tlet parentNode = dataNode[ND].parentNode;\n\n\t\tif(parentNode[ND].proxyNode && parentNode[ND].proxyNode[NID].status === proxyStatuses.ALIVE) {\n\t\t\treturn parentNode[ND].proxyNode[ND].proxy[ property ]; // proxy or primitive via parent's proxy object\n\t\t}\n\t\telse {\n\t\t\t// if we reached here then probably we are on a capture phase of a deep deletion.\n\t\t\t// for example 'obj.sub1.sub2' gets 'delete obj.sub1' so now there are no values for 'sub2' nor its parent 'sub1'.\n\t\t\t// the warning is turned off because this situation seems okay\n\t\t\t// console.warn(`reached a capture level where neither child not parent proxy-nodes exist`);\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\n/**\n * process event and then bubble up and capture down the data tree\n * @param dataNode\n * @param property\n * @param oldValue\n * @param wasOldValueProxy\n * @param value\n * @param isValueProxy\n */\nexport function initEmitEvent(\n\tdataNode: DataNode,\n\tproperty: string,\n\toldValue: any,\n\twasOldValueProxy: boolean,\n\tvalue: any,\n\tisValueProxy: boolean,\n) {\n\tif(oldValue === value // no new change was made\n\t|| !dataNode[ND].proxyNode) { // proxy-node is detached from data-node\n\t\treturn;\n\t}\n\n\tlet proxyNode = dataNode[ND].proxyNode;\n\tif(proxyNode[NID].status !== proxyStatuses.ALIVE) { // altered a deleted proxy\n\t\treturn;\n\t}\n\n\tlet changeType = eventNames.update;\n\tif(value === undefined) {\n\t\tchangeType = eventNames.delete;\n\t} else if(oldValue === undefined) {\n\t\tchangeType = eventNames.create;\n\t}\n\n\tlet deferredEvents: DeferredEvent[];\n\t// altering properties of an array that's in the middle of a splicing phase\n\tif(dataNode[NID].status === nodeStatuses.SPLICING) {\n\t\t// initiate (if needed) an object to hold side effect events\n\t\tif(!dataNode[ND].deferredEvents) {\n\t\t\tdataNode[ND].deferredEvents = [];\n\t\t}\n\t\t// save a reference to the deferredEvents\n\t\tdeferredEvents = dataNode[ND].deferredEvents;\n\t}\n\n\tlet path;\n\tif(dataNode[property]) { // changed a property which has its own data node on the tree\n\t\tdataNode = dataNode[property];\n\t\tpath = '';\n\t} else {\n\t\tpath = property2path(proxyNode[ND].target, property);\n\t}\n\n\tlet change: ChangeEvent = {\n\t\tpath, value, oldValue, type: changeType,\n\t};\n\n\tif(!deferredEvents) {\n\t\tbubbleEmit(dataNode, change, property);\n\t\n\t\tif(wasOldValueProxy || isValueProxy) { // old value or new value are proxy meaning they are objects with children\n\t\t\tcaptureEmit(dataNode, change);\n\t\t}\n\t}\n\telse {\n\t\tdeferredEvents.push({dataNode, change, shouldCapture: wasOldValueProxy || isValueProxy});\n\t}\n}\n\n/**\n * bubbling phase - go up the data tree and emit\n * @param dataNode\n * @param change\n * @param [property] - property name of the data-node (i.e. as the data-node is assigned to its parent)\n */\nfunction bubbleEmit(dataNode: DataNode, change: ChangeEvent, property?: string): void {\n\tif(dataNode[NID].status === nodeStatuses.STOPPED) {\n\t\treturn; // not allowed to emit\n\t}\n\n\tlet thisValue = getProxyValue(dataNode, property);\n\n\tif(change.path === '') { // iterate over 'shallow' listeners\n\t\titerateAndEmit(dataNode[ND].listeners.shallow, thisValue, change);\n\t}\n\n\t// iterate over 'deep' listeners\n\titerateAndEmit(dataNode[ND].listeners.deep, thisValue, change);\n\n\tif(!dataNode[ND].parentNode[ND].isTreePrototype) { // we are not on root node yet\n\t\t// create a shallow copy of 'change' and update its path\n\t\t// (we don't want to alter the 'change' object that was just emitted to a listener)\n\t\tlet nextChange: ChangeEvent = {\n\t\t\t...change,\n\t\t\tpath: dataNode[ND].propertyPath + change.path\n\t\t};\n\n\t\tbubbleEmit(dataNode[ND].parentNode, nextChange);\n\t}\n}\n\n/**\n * capturing phase - go down the data tree and emit\n * @param dataNode\n * @param change\n */\nfunction captureEmit(dataNode: DataNode, change: ChangeEvent): void {\n\tlet keys = Object.keys(dataNode);\n\tfor(let key of keys) {\n\t\tlet subValue = (typeof change.value === 'object' && change.value !== null) ? change.value[key] : undefined;\n\t\tlet subOldValue = (typeof change.oldValue === 'object' && change.oldValue !== null) ? change.oldValue[key] : undefined;\n\t\tif(subValue !== subOldValue) { //if not both undefined or same primitive or the same object\n\t\t\tlet changeType = eventNames.update;\n\t\t\tif(subValue === undefined) {\n\t\t\t\tchangeType = eventNames.delete;\n\t\t\t} else if(subOldValue === undefined) {\n\t\t\t\tchangeType = eventNames.create;\n\t\t\t}\n\n\t\t\tlet subChange: ChangeEvent = {\n\t\t\t\tpath: '',\n\t\t\t\toldValue: subOldValue,\n\t\t\t\tvalue: subValue,\n\t\t\t\ttype: changeType\n\t\t\t}\n\n\t\t\t// failing the status check will not emit for current property (but sub-properties might still be forcibly active)\n\t\t\tlet childNode = dataNode[key];\n\t\t\tif(childNode[NID].status !== nodeStatuses.STOPPED) {\n\t\t\t\tlet thisValue = getProxyValue(childNode, key);\n\t\t\t\titerateAndEmit(childNode[ND].listeners.shallow, thisValue, subChange);\n\t\t\t}\n\n\t\t\tcaptureEmit(childNode, subChange);\n\t\t}\n\t}\n}\n\n/**\n * iterate over an array of listeners, handle 'once' listeners and emit\n * @param listenersArr \n * @param thisValue \n * @param change \n */\nfunction iterateAndEmit(listenersArr: ListenerData[], thisValue: any, change: ChangeEvent): void {\n\tfor(let i = listenersArr.length - 1; i >= 0; i--) {\n\t\tlet listener = listenersArr[i];\n\t\tif(listener.type.includes(change.type)) {\n\t\t\tif(listener.once === true) {\n\t\t\t\tlistenersArr.splice(i, 1);\n\t\t\t}\n\t\t\tlistener.func.call(thisValue, change);\n\t\t}\n\t}\n}\n\n/**\n * process special event for a built-in method and then bubble up the data tree\n * @param dataNode\n * @param funcName - the method's name\n * @param funcArgs - the method's arguments\n * @param oldValue\n * @param value\n */\nexport function initFunctionEmitEvent(\n\tdataNode: DataNode,\n\tfuncName: eventNames,\n\tfuncArgs: ChangeEvent['args'],\n\toldValue: any,\n\tvalue: any,\n) {\n\tlet change: ChangeEvent = {\n\t\tpath: '', value, oldValue, type: funcName, args: funcArgs,\n\t};\n\n\tbubbleEmit(dataNode, change);\n\n\tif(dataNode[ND].deferredEvents) {\n\t\t// manually handle the side-effect events that were caught\n\t\t// in order to not bubble up, but should capture down\n\t\tfor(let event of dataNode[ND].deferredEvents) {\n\t\t\tif(event.change.path === '') {\n\t\t\t\t// no path means its an event directly on the property, not on the parent.\n\t\t\t\t// i.e: not an event with path \"0\" on \".arr\", but an event with no path on \".arr[0]\".\n\t\t\t\t// function event on \"arr\" already ran, but now a regular event on \"arr[0]\" is due\n\t\t\t\tlet thisValue = getProxyValue(event.dataNode);\n\t\t\t\titerateAndEmit(event.dataNode[ND].listeners.shallow, thisValue, event.change);\n\t\t\t\titerateAndEmit(event.dataNode[ND].listeners.deep, thisValue, event.change);\n\t\t\t}\n\n\t\t\tif(event.shouldCapture) {\n\t\t\t\tcaptureEmit(event.dataNode, event.change);\n\t\t\t}\n\t\t}\n\t\tdelete dataNode[ND].deferredEvents;\n\t}\n\telse {\n\t\tconsole.warn(`no side effect events for ${funcName} were made`);\n\t}\n}"],"names":[],"version":3,"file":"index.js.map"}